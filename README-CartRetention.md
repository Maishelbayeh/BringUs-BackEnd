# ูุธุงู ุญูุธ ุงูุณูุฉ ูููุณุชุฎุฏููู ุงูุถููู ๐

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุงูุณูุฉ ูุฏุนู ููุนูู ูู ุงููุณุชุฎุฏููู:
- **ุงููุณุชุฎุฏููู ุงููุณุฌููู** - ุณูุฉ ูุญููุธุฉ ุจุดูู ุฏุงุฆู
- **ุงููุณุชุฎุฏููู ุงูุถููู** - ุณูุฉ ูุญููุธุฉ ููุฏุฉ ูุญุฏูุฏุฉ

## โฐ ูุฏุฉ ุญูุธ ุงูุณูุฉ

### ูููุณุชุฎุฏููู ุงูุถููู:
- **ุงููุฏุฉ**: 30 ููู ูู ุขุฎุฑ ุชุญุฏูุซ
- **ุงูุญุฐู**: ุชููุงุฆู ุจูุงุณุทุฉ MongoDB TTL index
- **ุงูุชุญุฏูุซ**: ูู ูุฑุฉ ูุชู ูููุง ุฅุถุงูุฉ/ุชุนุฏูู/ุญุฐู ุนูุตุฑ

### ูููุณุชุฎุฏููู ุงููุณุฌููู:
- **ุงููุฏุฉ**: ุฏุงุฆูุฉ (ูุง ุชูุชูู)
- **ุงูุญุฐู**: ูุฏูู ููุท

## ๐ง ููููุฉ ุงูุนูู

### 1. ุฅูุดุงุก guestId
```javascript
// ุนูุฏ ุฃูู ุทูุจ ูู ูุณุชุฎุฏู ุถูู
const guestId = generateUUID(); // ูุซุงู: "550e8400-e29b-41d4-a716-446655440000"
```

### 2. ุญูุธ ุงูุณูุฉ
```javascript
// ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
{
  _id: ObjectId("..."),
  user: null,                    // ูููุณุชุฎุฏููู ุงูุถููู
  guestId: "550e8400-e29b-41d4-a716-446655440000",
  store: ObjectId("store_id"),
  items: [...],
  createdAt: ISODate("2024-01-01T10:00:00Z"),
  updatedAt: ISODate("2024-01-01T10:00:00Z")  // ูุฐุง ุงูุญูู ูุญุฏุฏ ููุช ุงูุญุฐู
}
```

### 3. TTL Index
```javascript
// ุญุฐู ุชููุงุฆู ุจุนุฏ 30 ููู ูู ุขุฎุฑ ุชุญุฏูุซ
cartSchema.index({ updatedAt: 1 }, { 
  expireAfterSeconds: 2592000, // 30 days
  partialFilterExpression: { guestId: { $exists: true, $ne: null } } 
});
```

## ๐ ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ูุณุชุฎุฏู ุถูู ูุถูู ููุชุฌ
```
ุงูุชุงุฑูุฎ: 1 ููุงูุฑ 2024
ุงูุฅุฌุฑุงุก: ุฅุถุงูุฉ ููุชุฌ ุฅูู ุงูุณูุฉ
ุงููุชูุฌุฉ: updatedAt = 1 ููุงูุฑ 2024
ุงูุญุฐู: 31 ููุงูุฑ 2024 (ุชููุงุฆู)
```

### ูุซุงู 2: ูุณุชุฎุฏู ุถูู ูุญุฏุซ ุงูุณูุฉ
```
ุงูุชุงุฑูุฎ: 15 ููุงูุฑ 2024
ุงูุฅุฌุฑุงุก: ุชุญุฏูุซ ูููุฉ ููุชุฌ
ุงููุชูุฌุฉ: updatedAt = 15 ููุงูุฑ 2024
ุงูุญุฐู: 14 ูุจุฑุงูุฑ 2024 (ุชููุงุฆู)
```

### ูุซุงู 3: ูุณุชุฎุฏู ุถูู ูุณุฌู ุฏุฎูู
```
ุงูุชุงุฑูุฎ: 20 ููุงูุฑ 2024
ุงูุฅุฌุฑุงุก: ุชุณุฌูู ุฏุฎูู
ุงููุชูุฌุฉ: ุฏูุฌ ุงูุณูุฉ ูุน ุญุณุงุจ ุงููุณุชุฎุฏู
ุงูุญุฐู: ูุง ูุชู ุญุฐููุง (ุชุตุจุญ ุฏุงุฆูุฉ)
```

## ๐๏ธ ุชุบููุฑ ูุฏุฉ ุงูุญูุธ

### ูุญูุธ ููุฏุฉ 7 ุฃูุงู:
```javascript
cartSchema.index({ updatedAt: 1 }, { 
  expireAfterSeconds: 604800, // 7 days
  partialFilterExpression: { guestId: { $exists: true, $ne: null } } 
});
```

### ูุญูุธ ููุฏุฉ 24 ุณุงุนุฉ:
```javascript
cartSchema.index({ updatedAt: 1 }, { 
  expireAfterSeconds: 86400, // 24 hours
  partialFilterExpression: { guestId: { $exists: true, $ne: null } } 
});
```

### ูุญูุธ ุฏุงุฆู (ุฅูุบุงุก TTL):
```javascript
// ุชุนููู ุฃู ุญุฐู ุงูุณุทุฑ ุงูุชุงูู
// cartSchema.index({ updatedAt: 1 }, { ... });
```

## ๐ ูุฑุงูุจุฉ ุงูุณูุงุช

### ุงุณุชุนูุงู ูุฑุคูุฉ ุงูุณูุงุช ุงูุญุงููุฉ:
```javascript
// ุฌููุน ุงูุณูุงุช
db.carts.find()

// ุณูุงุช ุงูุถููู ููุท
db.carts.find({ guestId: { $exists: true, $ne: null } })

// ุณูุงุช ุงููุณุชุฎุฏููู ุงููุณุฌููู ููุท
db.carts.find({ user: { $exists: true, $ne: null } })
```

### ุงุณุชุนูุงู ูุฑุคูุฉ ุงูุณูุงุช ุงูุชู ุณุชุญุฐู ูุฑูุจุงู:
```javascript
// ุงูุณูุงุช ุงูุชู ุณุชุญุฐู ุฎูุงู 7 ุฃูุงู
db.carts.find({
  guestId: { $exists: true, $ne: null },
  updatedAt: { 
    $lt: new Date(Date.now() - 23 * 24 * 60 * 60 * 1000) 
  }
})
```

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **TTL Index ูุนูู ูู ุฏูููุฉ** - ูุง ูุชู ุงูุญุฐู ููุฑุงู
2. **ุงูุชุญุฏูุซ ูุทูู ุงููุฏุฉ** - ุฃู ุฅุฌุฑุงุก ุนูู ุงูุณูุฉ ูุทูู ูุฏุฉ ุงูุญูุธ
3. **ุงูุญุฐู ููุงุฆู** - ูุง ูููู ุงุณุชุฑุฌุงุน ุงูุณูุฉ ุงููุญุฐููุฉ
4. **ุงููุณุชุฎุฏููู ุงููุณุฌููู** - ูุง ูุชุฃุซุฑูู ุจู TTL index

## ๐ฏ ุฃูุถู ุงูููุงุฑุณุงุช

1. **ุฅุดุนุงุฑ ุงููุณุชุฎุฏููู** - ุชูุจูู ุงููุณุชุฎุฏููู ูุจู ุงูุชูุงุก ูุฏุฉ ุงูุณูุฉ
2. **ุญูุธ ุงูุจูุงูุงุช ุงููููุฉ** - ูุณุฎ ุงุญุชูุงุทูุฉ ููุจูุงูุงุช ุงููููุฉ
3. **ูุฑุงูุจุฉ ุงูุฃุฏุงุก** - ูุฑุงูุจุฉ ุญุฌู ูุงุนุฏุฉ ุงูุจูุงูุงุช
4. **ุชุญุฏูุซ TTL** - ุชุนุฏูู ุงููุฏุฉ ุญุณุจ ุงุญุชูุงุฌุงุช ุงูุนูู

## ๐ ุงูุฏุนู

ูุฃู ุงุณุชูุณุงุฑุงุช ุญูู ูุธุงู ุญูุธ ุงูุณูุฉุ ูุฑุฌู ุงูุชูุงุตู ูุน ูุฑูู ุงูุชุทููุฑ. 